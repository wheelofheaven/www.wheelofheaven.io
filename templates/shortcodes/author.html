{# Author Blockquote Shortcode #} {% set author_key = author | default(value="")
%} {% set name = name | default(value="") %} {% set title = title |
default(value="") %} {% set work = work | default(value="") %} {% set year =
year | default(value="") %} {% set url = url | default(value="") %} {% if
author_key %} {% set authors = load_data(path="authors.toml") %} {% set
author_data = authors.authors[author_key] %} {% endif %}

<blockquote class="wiki-content">
    <div class="blockquote-content">{{ body | markdown | safe }}</div>

    {% if author_key and author_data %}
    <div class="author-profile__container">
        <!-- Work Section (Left) -->
        {% if work or url or year %}
        <div class="author-profile__work-section">
            <div class="author-profile__work">
                {% if url %}
                <a
                    href="{{ url }}"
                    class="author-profile__work-link"
                    target="_blank"
                    rel="noopener noreferrer"
                >
                    {{ work | default(value="Source") }}
                </a>
                {% else %}
                <span class="author-profile__work-title">{{ work }}</span>
                {% endif %} {% if year %}
                <span class="author-profile__work-year">({{ year }})</span>
                {% endif %}
            </div>
        </div>
        {% endif %}

        <!-- Author Section (Right) -->
        <div class="author-profile__author-section">
            {% if author_data.image %}
            <img
                class="author-profile__avatar"
                src="{{ get_url(path=author_data.image) }}"
                alt="{{ author_data.name }}"
                onerror="this.classList.add('hidden'); this.nextElementSibling.classList.remove('hidden');"
            />
            {% endif %}
            <div
                class="author-profile__avatar author-profile__avatar--placeholder{% if author_data.image %} hidden{% endif %}"
            >
                {{ author_data.name | truncate(length=1, end="") | upper }}
            </div>

            <div class="author-profile__info">
                <div class="author-profile__name">{{ author_data.name }}</div>
                {% if author_data.title %}
                <div class="author-profile__title">{{ author_data.title }}</div>
                {% endif %} {% if author_data.birth_year %}
                <div class="author-profile__dates">
                    {{ author_data.birth_year }}{% if author_data.death_year %}
                    - {{ author_data.death_year }}{% endif %}
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    {% elif name %}
    <div class="author-profile__container">
        <!-- Work Section (Left) -->
        {% if work or url or year %}
        <div class="author-profile__work-section">
            <div class="author-profile__work">
                {% if url %}
                <a
                    href="{{ url }}"
                    class="author-profile__work-link"
                    target="_blank"
                    rel="noopener noreferrer"
                >
                    {{ work | default(value="Source") }}
                </a>
                {% else %}
                <span class="author-profile__work-title">{{ work }}</span>
                {% endif %} {% if year %}
                <span class="author-profile__work-year">({{ year }})</span>
                {% endif %}
            </div>
        </div>
        {% endif %}

        <!-- Author Section (Right) -->
        <div class="author-profile__author-section">
            <div
                class="author-profile__avatar author-profile__avatar--placeholder"
            >
                {{ name | truncate(length=1, end="") | upper }}
            </div>
            <div class="author-profile__info">
                <div class="author-profile__name">{{ name }}</div>
                {% if title %}
                <div class="author-profile__title">{{ title }}</div>
                {% endif %}
            </div>
        </div>
    </div>

    {% else %}
    <cite>{{ author_key }}</cite>
    {% endif %}
</blockquote>
