{% extends "base.html" %}
{% import "macros/breadcrumbs.html" as breadcrumbs %}

{% block content %}
<!-- HowTo Schema for step-by-step guides -->
{% include "partials/schema/how-to.html" %}

<div class="essentials">
    <!-- Breadcrumb Navigation -->
    {{ breadcrumbs::essentials(page=page, lang=detected_lang) }}

    <div class="essentials__container">
        <!-- Main Content -->
        <main class="essentials__main">
            <article class="essentials__article" role="article" aria-labelledby="essentials-title">
                <!-- Hero Image Section -->
                {% if page.extra.header_image %}
                <div class="essentials__hero">
                    <img
                        src="{{ page.extra.header_image }}"
                        alt="{{ page.title }}"
                        class="essentials__hero-image"
                    />
                    {% if page.extra.order %}
                    <div class="essentials__step-indicator" aria-label="Step {{ page.extra.order }} of the essentials guide">
                        Step {% if page.extra.order < 10 %}0{% endif %}{{ page.extra.order }}
                    </div>
                    {% endif %}
                    <div class="essentials__hero-overlay">
                        <h1 class="essentials__hero-title" id="essentials-title">{{ page.title }}</h1>
                    </div>
                </div>
                {% else %}
                <div class="essentials__hero essentials__hero--no-image">
                    {% if page.extra.order %}
                    <div class="essentials__step-indicator" aria-label="Step {{ page.extra.order }} of the essentials guide">
                        Step {% if page.extra.order < 10 %}0{% endif %}{{ page.extra.order }}
                    </div>
                    {% endif %}
                    <div class="essentials__hero-overlay">
                        <h1 class="essentials__hero-title" id="essentials-title">{{ page.title }}</h1>
                    </div>
                </div>
                {% endif %}

                <!-- Page Header -->
                <header class="essentials__header">
                    <!-- Listen Button & Share -->
                    <div class="essentials__actions">
                        {% include "partials/listen-button.html" %}
                        {% include "partials/social-share.html" %}
                    </div>
                </header>

                <!-- Page Content -->
                {% if page.content %}
                <div class="essentials__content">{{ page.content | safe }}</div>
                {% endif %}

                <!-- Navigation Section -->
                <nav class="essentials__navigation" role="navigation" aria-label="Essentials page navigation">
                    <!-- Previous/Next Navigation -->
                    {% if page.extra.prev_page and page.extra.next_page %}
                    <div class="essentials__prev-next">
                    {% elif page.extra.prev_page and not page.extra.next_page %}
                    <div class="essentials__prev-next essentials__prev-next--prev-only">
                    {% elif page.extra.next_page and not page.extra.prev_page %}
                    <div class="essentials__prev-next essentials__prev-next--next-only">
                    {% else %}
                    <div class="essentials__prev-next">
                    {% endif %}
                        <!-- Previous Page -->
                        {% if page.extra.prev_page %}
                        <a
                            href="{{ page.extra.prev_page.url }}"
                            class="essentials__nav-btn essentials__nav-btn--prev"
                            aria-label="Previous: {{ page.extra.prev_page.title }}"
                        >
                            <svg
                                class="essentials__nav-icon"
                                width="20"
                                height="20"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                            >
                                <polyline points="15,18 9,12 15,6"></polyline>
                            </svg>
                            <div class="essentials__nav-content">
                                <span class="essentials__nav-label"
                                    >Previous</span
                                >
                                <span class="essentials__nav-title"
                                    >{{ page.extra.prev_page.title }}</span
                                >
                            </div>
                        </a>
                        {% endif %}

                        <!-- Next Page -->
                        {% if page.extra.next_page %}
                        <a
                            href="{{ page.extra.next_page.url }}"
                            class="essentials__nav-btn essentials__nav-btn--next"
                            aria-label="Next: {{ page.extra.next_page.title }}"
                        >
                            <div class="essentials__nav-content">
                                <span class="essentials__nav-label">Next</span>
                                <span class="essentials__nav-title"
                                    >{{ page.extra.next_page.title }}</span
                                >
                            </div>
                            <svg
                                class="essentials__nav-icon"
                                width="20"
                                height="20"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                            >
                                <polyline points="9,18 15,12 9,6"></polyline>
                            </svg>
                        </a>
                        {% endif %}
                    </div>

                    <!-- Related Content CTA -->
                    {% if page.extra.related_content %}
                    <div class="essentials__related">
                        <div class="essentials__related-content">
                            <h4 class="essentials__related-title">
                                {{ page.extra.related_content.title |
                                default(value="Dive Deeper") }}
                            </h4>
                            {% if page.extra.related_content.description %}
                            <p class="essentials__related-description">
                                {{ page.extra.related_content.description }}
                            </p>
                            {% endif %}
                        </div>
                        <a
                            href="{{ page.extra.related_content.url }}"
                            class="essentials__related-btn"
                        >
                            {% if page.extra.related_content.type == "wiki" %}
                            <svg
                                class="essentials__related-icon"
                                width="16"
                                height="16"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                            >
                                <path
                                    d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
                                ></path>
                                <polyline points="14,2 14,8 20,8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                            </svg>
                            {% elif page.extra.related_content.type ==
                            "explainer" %}
                            <svg
                                class="essentials__related-icon"
                                width="16"
                                height="16"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                            >
                                <circle cx="12" cy="12" r="3"></circle>
                                <path
                                    d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"
                                ></path>
                            </svg>
                            {% else %}
                            <svg
                                class="essentials__related-icon"
                                width="16"
                                height="16"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                            >
                                <polyline points="9,18 15,12 9,6"></polyline>
                            </svg>
                            {% endif %} {{ page.extra.related_content.link_text
                            | default(value="Read More") }}
                        </a>
                    </div>
                    {% endif %}

                    <!-- Back to Essentials Hub -->
                    <div class="essentials__hub-link">
                        <a
                            href="{{ get_url(path='essentials/', lang=detected_lang) }}"
                            class="essentials__hub-btn"
                        >
                            <svg
                                class="essentials__hub-icon"
                                width="16"
                                height="16"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                            >
                                <path
                                    d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
                                ></path>
                                <polyline
                                    points="9,22 9,12 15,12 15,22"
                                ></polyline>
                            </svg>
                            Back to Essentials
                        </a>
                    </div>
                </nav>
            </article>
        </main>
    </div>
</div>
{% endblock content %}
